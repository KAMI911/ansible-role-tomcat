name: Test Ansible Module

on:
  push:
    branches: [ master ]
  workflow_dispatch:

jobs:
  update-plalist:
    runs-on: ubuntu-latest

    steps:
      - uses: actions/checkout@v2
      - name: Install Ansible module test
        run: |
          apk update && apk add --no-cache openrc docker python3-dev py3-pip gcc git curl build-base autoconf automake py3-cryptography linux-headers musl-dev libffi-dev openssl-dev openssh
          docker info
          python3 --version
          pip3 install ansible molecule docker 'molecule[docker]'
          ansible --version
          molecule test
